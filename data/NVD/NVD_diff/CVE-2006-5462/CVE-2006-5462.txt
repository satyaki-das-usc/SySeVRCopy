--- ../firefox-1.5.0.7/security/nss/lib/softoken/rsawrapr.c	2005-04-04 11:27:42.000000000 +0200
+++ security/nss/lib/softoken/rsawrapr.c	2006-08-04 21:10:53.000000000 +0200
@@ -509,11 +535,11 @@
     if (buffer[0] != 0 || buffer[1] != 1) 
     	goto loser;
     for (i = 2; i < modulus_len - hash_len - 1; i++) {
-	if (buffer[i] == 0) 
-	    break;
 	if (buffer[i] != 0xff) 
 	    goto loser;
     }
+    if (buffer[i] != 0) 
+	goto loser;
 
     /*
      * make sure we get the same results
