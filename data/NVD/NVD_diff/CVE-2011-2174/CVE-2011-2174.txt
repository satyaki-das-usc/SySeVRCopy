diff --git a/epan/tvbuff.c b/epan/tvbuff.c
--- a/epan/tvbuff.c	2011/05/12 15:48:51	37080
+++ b/epan/tvbuff.c	2011/05/12 16:31:42	37081
@@ -3425,9 +3425,9 @@
 			inflateEnd(strm);
 			g_free(strm);
 			g_free(strmbuf);
-			g_free(compr);
 
 			if (uncompr == NULL) {
+				g_free(compr);
 				return NULL;
 			}